/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
import { isNull } from './object';
/**
 * @param {?} opts
 * @return {?}
 */
export function toPoint(opts) {
    if (!opts) {
        return new window.BMap.Point();
    }
    return new window.BMap.Point(opts.lng, opts.lat);
}
/**
 * @param {?} opts
 * @return {?}
 */
export function toPoints(opts) {
    if (!opts) {
        return [];
    }
    return opts.map(function (p) {
        return new window.BMap.Point(p.lng, p.lat);
    });
}
/**
 * @param {?} opts
 * @return {?}
 */
export function toSize(opts) {
    if (!opts) {
        return new window.BMap.Size();
    }
    return new window.BMap.Size(opts.width, opts.height);
}
/**
 * @param {?} url
 * @param {?} size
 * @param {?} options
 * @return {?}
 */
export function toIcon(url, size, options) {
    if (!size && !options) {
        return new window.BMap.Icon(url);
    }
    if (!size) {
        return new window.BMap.Icon(url, toSize(size));
    }
    var /** @type {?} */ iconOptions = {
        anchor: toSize(options.anchor),
        imageOffset: toSize(options.imageOffset),
        infoWindowAnchor: toSize(options.infoWindowAnchor),
        printImageUrl: options.printImageUrl
    };
    var /** @type {?} */ icon = new window.BMap.Icon(url, toSize(size), iconOptions);
    if (options.imageSize) {
        icon.setImageSize(toSize(options.imageSize));
    }
    return icon;
}
/**
 * @param {?} options
 * @return {?}
 */
export function toMarkerOptions(options) {
    var /** @type {?} */ opts = {};
    if (!options) {
        return opts;
    }
    if (options.offset) {
        opts.offset = toSize(options.offset);
    }
    if (options.icon) {
        opts.icon = toIcon(options.icon.imageUrl, options.icon.size, options.icon);
    }
    if (!isNull(options.enableMassClear)) {
        opts.enableMassClear = options.enableMassClear;
    }
    if (!isNull(options.enableDragging)) {
        opts.enableDragging = options.enableDragging;
    }
    if (!isNull(options.enableClicking)) {
        opts.enableClicking = options.enableClicking;
    }
    if (!isNull(options.raiseOnDrag)) {
        opts.raiseOnDrag = options.raiseOnDrag;
    }
    if (!isNull(options.draggingCursor)) {
        opts.draggingCursor = options.draggingCursor;
    }
    if (!isNull(options.rotation)) {
        opts.rotation = options.rotation;
    }
    if (!isNull(options.title)) {
        opts.title = options.title;
    }
    if (!isNull(options.shadow)) {
        opts.shadow = toIcon(options.shadow.imageUrl, options.shadow.size, options.shadow);
    }
    return opts;
}
/**
 * @param {?} options
 * @return {?}
 */
export function toNavigationControlOptions(options) {
    var /** @type {?} */ opts = {};
    if (!options) {
        return opts;
    }
    if (!isNull(options.anchor)) {
        opts.anchor = options.anchor;
    }
    if (!isNull(options.enableGeolocation)) {
        opts.enableGeolocation = options.enableGeolocation;
    }
    if (!isNull(options.offset)) {
        opts.offset = toSize(options.offset);
    }
    if (!isNull(options.showZoomInfo)) {
        opts.showZoomInfo = options.showZoomInfo;
    }
    if (!isNull(options.type)) {
        opts.type = options.type;
    }
    return opts;
}
/**
 * @param {?} options
 * @return {?}
 */
export function toOverviewMapControlOptions(options) {
    var /** @type {?} */ opts = {};
    if (!options) {
        return opts;
    }
    if (!isNull(options.anchor)) {
        opts.anchor = options.anchor;
    }
    if (!isNull(options.isOpen)) {
        opts.isOpen = options.isOpen;
    }
    if (!isNull(options.offset)) {
        opts.offset = toSize(options.offset);
    }
    if (!isNull(options.size)) {
        opts.size = toSize(options.size);
    }
    return opts;
}
/**
 * @param {?} options
 * @return {?}
 */
export function toScaleControlOptions(options) {
    var /** @type {?} */ opts = {};
    if (!options) {
        return opts;
    }
    if (!isNull(options.anchor)) {
        opts.anchor = options.anchor;
    }
    if (!isNull(options.offset)) {
        opts.offset = toSize(options.offset);
    }
    return opts;
}
/**
 * @param {?} options
 * @return {?}
 */
export function toMapTypeControlOptions(options) {
    var /** @type {?} */ opts = {};
    if (!options) {
        return opts;
    }
    if (!isNull(options.type)) {
        opts.type = options.type;
    }
    return opts;
}
/**
 * @param {?} options
 * @return {?}
 */
export function toGeolocationOptions(options) {
    var /** @type {?} */ opts = {};
    if (!options) {
        return opts;
    }
    if (!isNull(options.anchor)) {
        opts.anchor = options.anchor;
    }
    if (!isNull(options.offset)) {
        opts.offset = toSize(options.offset);
    }
    if (!isNull(options.enableAutoLocation)) {
        opts.enableAutoLocation = options.enableAutoLocation;
    }
    if (!isNull(options.locationIcon)) {
        opts.locationIcon = toIcon(options.locationIcon.imageUrl, options.locationIcon.size, options.locationIcon);
    }
    if (!isNull(options.showAddressBar)) {
        opts.showAddressBar = options.showAddressBar;
    }
    return opts;
}
/**
 * @param {?} style
 * @return {?}
 */
export function toTextIconStyle(style) {
    var /** @type {?} */ realStyle = {
        url: style.url,
        size: toSize(style.size)
    };
    if (style.anchor) {
        realStyle.anchor = toSize(style.anchor);
    }
    if (style.offset) {
        realStyle.offset = toSize(style.offset);
    }
    if (!isNull(style.textSize)) {
        realStyle.textSize = style.textSize;
    }
    if (!isNull(style.textColor)) {
        realStyle.textColor = style.textColor;
    }
    return realStyle;
}
/**
 * @param {?} options
 * @return {?}
 */
export function toMarkerClustererOptions(options) {
    var /** @type {?} */ opts = {};
    if (!options) {
        return opts;
    }
    if (options.markers) {
        opts.markers = options.markers.map(function (m) { return new window.BMap.Marker(toPoint(m.point), toMarkerOptions(m.options)); });
    }
    if (!isNull(options.girdSize)) {
        opts.girdSize = options.girdSize;
    }
    if (!isNull(options.maxZoom)) {
        opts.maxZoom = options.maxZoom;
    }
    if (!isNull(options.minClusterSize)) {
        opts.minClusterSize = options.minClusterSize;
    }
    if (!isNull(options.isAverangeCenter)) {
        opts.isAverangeCenter = options.isAverangeCenter;
    }
    if (options.styles) {
        opts.styles = options.styles.filter(function (s) { return s; }).map(function (s) { return toTextIconStyle(s); });
    }
    return opts;
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidHJhbnNmb3JtZXIuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9hbmd1bGFyMi1iYWlkdS1tYXAvIiwic291cmNlcyI6WyJoZWxwZXJzL3RyYW5zZm9ybWVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFpQkEsT0FBTyxFQUFFLE1BQU0sRUFBRSxNQUFNLFVBQVUsQ0FBQTs7Ozs7QUFJakMsTUFBTSxrQkFBa0IsSUFBVztJQUNqQyxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7UUFDVixNQUFNLENBQUMsSUFBSSxNQUFNLENBQUMsSUFBSSxDQUFDLEtBQUssRUFBRSxDQUFBO0tBQy9CO0lBQ0QsTUFBTSxDQUFDLElBQUksTUFBTSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUE7Q0FDakQ7Ozs7O0FBRUQsTUFBTSxtQkFBbUIsSUFBa0I7SUFDekMsRUFBRSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO1FBQ1YsTUFBTSxDQUFDLEVBQUUsQ0FBQTtLQUNWO0lBQ0QsTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsVUFBQSxDQUFDO1FBQ2YsTUFBTSxDQUFDLElBQUksTUFBTSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLEdBQUcsRUFBRSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUE7S0FDM0MsQ0FBQyxDQUFBO0NBQ0g7Ozs7O0FBRUQsTUFBTSxpQkFBaUIsSUFBVTtJQUMvQixFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7UUFDVixNQUFNLENBQUMsSUFBSSxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxDQUFBO0tBQzlCO0lBQ0QsTUFBTSxDQUFDLElBQUksTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssRUFBRSxJQUFJLENBQUMsTUFBTSxD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IHtcbiAgQkdlb2xvY2F0aW9uQ29udHJvbE9wdGlvbnMsXG4gIEJNYXBUeXBlQ29udHJvbE9wdGlvbnMsXG4gIEJOYXZpZ2F0aW9uQ29udHJvbE9wdGlvbnMsXG4gIEJPdmVydmlld01hcENvbnRyb2xPcHRpb25zLFxuICBCU2NhbGVDb250cm9sT3B0aW9ucyxcbiAgR2VvbG9jYXRpb25Db250cm9sT3B0aW9ucyxcbiAgTWFwVHlwZUNvbnRyb2xPcHRpb25zLFxuICBOYXZpZ2F0aW9uQ29udHJvbE9wdGlvbnMsXG4gIE92ZXJ2aWV3TWFwQ29udHJvbE9wdGlvbnMsXG4gIFNjYWxlQ29udHJvbE9wdGlvbnNcbn0gZnJvbSAnLi4vdHlwZXMvQ29udHJvbCdcbmltcG9ydCB7IEJJY29uLCBJY29uT3B0aW9ucyB9IGZyb20gJy4uL3R5cGVzL0ljb24nXG5pbXBvcnQgeyBCTWFya2VyT3B0aW9ucywgTWFya2VyT3B0aW9ucyB9IGZyb20gJy4uL3R5cGVzL01hcmtlcidcbmltcG9ydCB7IEJQb2ludCwgUG9pbnQgfSBmcm9tICcuLi90eXBlcy9Qb2ludCdcbmltcG9ydCB7IEJTaXplLCBTaXplIH0gZnJvbSAnLi4vdHlwZXMvU2l6ZSdcblxuaW1wb3J0IHsgaXNOdWxsIH0gZnJvbSAnLi9vYmplY3QnXG5pbXBvcnQgeyBCTWFya2VyQ2x1c3RlcmVyT3B0aW9ucywgTWFya2VyQ2x1c3RlcmVyT3B0aW9ucyB9IGZyb20gJy4uL3R5cGVzL01hcmtlckNsdXN0ZXJlcidcbmltcG9ydCB7IFRleHRJY29uU3R5bGUsIEJUZXh0SWNvblN0eWxlIH0gZnJvbSAnLi4vdHlwZXMvVGV4dEljb25PdmVybGF5J1xuXG5leHBvcnQgZnVuY3Rpb24gdG9Qb2ludChvcHRzOiBQb2ludCk6IEJQb2ludCB7XG4gIGlmICghb3B0cykge1xuICAgIHJldHVybiBuZXcgd2luZG93LkJNYXAuUG9pbnQoKVxuICB9XG4gIHJldHVybiBuZXcgd2luZG93LkJNYXAuUG9pbnQob3B0cy5sbmcsIG9wdHMubGF0KVxufVxuXG5leHBvcnQgZnVuY3Rpb24gdG9Qb2ludHMob3B0czogQXJyYXk8UG9pbnQ+KTogQXJyYXk8QlBvaW50PiB7XG4gIGlmICghb3B0cykge1xuICAgIHJldHVybiBbXVxuICB9XG4gIHJldHVybiBvcHRzLm1hcChwID0+IHtcbiAgICByZXR1cm4gbmV3IHdpbmRvdy5CTWFwLlBvaW50KHAubG5nLCBwLmxhdClcbiAgfSlcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHRvU2l6ZShvcHRzOiBTaXplKTogQlNpemUge1xuICBpZiAoIW9wdHMpIHtcbiAgICByZXR1cm4gbmV3IHdpbmRvdy5CTWFwLlNpemUoKVxuICB9XG4gIHJldHVybiBuZXcgd2luZG93LkJNYXAuU2l6ZShvcHRzLndpZHRoLCBvcHRzLmhlaWdodClcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHRvSWNvbih1cmw6IHN0cmluZywgc2l6ZTogU2l6ZSwgb3B0aW9uczogSWNvbk9wdGlvbnMpOiBCSWNvbiB7XG4gIGlmICghc2l6ZSAmJiAhb3B0aW9ucykge1xuICAgIHJldHVybiBuZXcgd2luZG93LkJNYXAuSWNvbih1cmwpXG4gIH1cbiAgaWYgKCFzaXplKSB7XG4gICAgcmV0dXJuIG5ldyB3aW5kb3cuQk1hcC5JY29uKHVybCwgdG9TaXplKHNpemUpKVxuICB9XG4gIGNvbnN0IGljb25PcHRpb25zOiBhbnkgPSB7XG4gICAgYW5jaG9yOiB0b1NpemUob3B0aW9ucy5hbmNob3IpLFxuICAgIGltYWdlT2Zmc2V0OiB0b1NpemUob3B0aW9ucy5pbWFnZU9mZnNldCksXG4gICAgaW5mb1dpbmRvd0FuY2hvcjogdG9TaXplKG9wdGlvbnMuaW5mb1dpbmRvd0FuY2hvciksXG4gICAgcHJpbnRJbWFnZVVybDogb3B0aW9ucy5wcmludEltYWdlVXJsXG4gIH1cbiAgY29uc3QgaWNvbiA9IG5ldyB3aW5kb3cuQk1hcC5JY29uKHVybCwgdG9TaXplKHNpemUpLCBpY29uT3B0aW9ucylcbiAgaWYgKG9wdGlvbnMuaW1hZ2VTaXplKSB7XG4gICAgaWNvbi5zZXRJbWFnZVNpemUodG9TaXplKG9wdGlvbnMuaW1hZ2VTaXplKSlcbiAgfVxuICByZXR1cm4gaWNvblxufVxuXG5leHBvcnQgZnVuY3Rpb24gdG9NYXJrZXJPcHRpb25zKG9wdGlvbnM6IE1hcmtlck9wdGlvbnMpOiBCTWFya2VyT3B0aW9ucyB7XG4gIGNvbnN0IG9wdHM6IEJNYXJrZXJPcHRpb25zID0ge31cblxuICBpZiAoIW9wdGlvbnMpIHtcbiAgICByZXR1cm4gb3B0c1xuICB9XG5cbiAgaWYgKG9wdGlvbnMub2Zmc2V0KSB7XG4gICAgb3B0cy5vZmZzZXQgPSB0b1NpemUob3B0aW9ucy5vZmZzZXQpXG4gIH1cblxuICBpZiAob3B0aW9ucy5pY29uKSB7XG4gICAgb3B0cy5pY29uID0gdG9JY29uKG9wdGlvbnMuaWNvbi5pbWFnZVVybCwgb3B0aW9ucy5pY29uLnNpemUsIG9wdGlvbnMuaWNvbilcbiAgfVxuICBpZiAoIWlzTnVsbChvcHRpb25zLmVuYWJsZU1hc3NDbGVhcikpIHtcbiAgICBvcHRzLmVuYWJsZU1hc3NDbGVhciA9IG9wdGlvbnMuZW5hYmxlTWFzc0NsZWFyXG4gIH1cbiAgaWYgKCFpc051bGwob3B0aW9ucy5lbmFibGVEcmFnZ2luZykpIHtcbiAgICBvcHRzLmVuYWJsZURyYWdnaW5nID0gb3B0aW9ucy5lbmFibGVEcmFnZ2luZ1xuICB9XG4gIGlmICghaXNOdWxsKG9wdGlvbnMuZW5hYmxlQ2xpY2tpbmcpKSB7XG4gICAgb3B0cy5lbmFibGVDbGlja2luZyA9IG9wdGlvbnMuZW5hYmxlQ2xpY2tpbmdcbiAgfVxuICBpZiAoIWlzTnVsbChvcHRpb25zLnJhaXNlT25EcmFnKSkge1xuICAgIG9wdHMucmFpc2VPbkRyYWcgPSBvcHRpb25zLnJhaXNlT25EcmFnXG4gIH1cbiAgaWYgKCFpc051bGwob3B0aW9ucy5kcmFnZ2luZ0N1cnNvcikpIHtcbiAgICBvcHRzLmRyYWdnaW5nQ3Vyc29yID0gb3B0aW9ucy5kcmFnZ2luZ0N1cnNvclxuICB9XG4gIGlmICghaXNOdWxsKG9wdGlvbnMucm90YXRpb24pKSB7XG4gICAgb3B0cy5yb3RhdGlvbiA9IG9wdGlvbnMucm90YXRpb25cbiAgfVxuICBpZiAoIWlzTnVsbChvcHRpb25zLnRpdGxlKSkge1xuICAgIG9wdHMudGl0bGUgPSBvcHRpb25zLnRpdGxlXG4gIH1cbiAgaWYgKCFpc051bGwob3B0aW9ucy5zaGFkb3cpKSB7XG4gICAgb3B0cy5zaGFkb3cgPSB0b0ljb24ob3B0aW9ucy5zaGFkb3cuaW1hZ2VVcmwsIG9wdGlvbnMuc2hhZG93LnNpemUsIG9wdGlvbnMuc2hhZG93KVxuICB9XG5cbiAgcmV0dXJuIG9wdHNcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHRvTmF2aWdhdGlvbkNvbnRyb2xPcHRpb25zKG9wdGlvbnM6IE5hdmlnYXRpb25Db250cm9sT3B0aW9ucyk6IEJOYXZpZ2F0aW9uQ29udHJvbE9wdGlvbnMge1xuICBjb25zdCBvcHRzOiBCTmF2aWdhdGlvbkNvbnRyb2xPcHRpb25zID0ge31cblxuICBpZiAoIW9wdGlvbnMpIHtcbiAgICByZXR1cm4gb3B0c1xuICB9XG5cbiAgaWYgKCFpc051bGwob3B0aW9ucy5hbmNob3IpKSB7XG4gICAgb3B0cy5hbmNob3IgPSBvcHRpb25zLmFuY2hvclxuICB9XG4gIGlmICghaXNOdWxsKG9wdGlvbnMuZW5hYmxlR2VvbG9jYXRpb24pKSB7XG4gICAgb3B0cy5lbmFibGVHZW9sb2NhdGlvbiA9IG9wdGlvbnMuZW5hYmxlR2VvbG9jYXRpb25cbiAgfVxuICBpZiAoIWlzTnVsbChvcHRpb25zLm9mZnNldCkpIHtcbiAgICBvcHRzLm9mZnNldCA9IHRvU2l6ZShvcHRpb25zLm9mZnNldClcbiAgfVxuICBpZiAoIWlzTnVsbChvcHRpb25zLnNob3dab29tSW5mbykpIHtcbiAgICBvcHRzLnNob3dab29tSW5mbyA9IG9wdGlvbnMuc2hvd1pvb21JbmZvXG4gIH1cblxuICBpZiAoIWlzTnVsbChvcHRpb25zLnR5cGUpKSB7XG4gICAgb3B0cy50eXBlID0gb3B0aW9ucy50eXBlXG4gIH1cbiAgcmV0dXJuIG9wdHNcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHRvT3ZlcnZpZXdNYXBDb250cm9sT3B0aW9ucyhvcHRpb25zOiBPdmVydmlld01hcENvbnRyb2xPcHRpb25zKTogQk92ZXJ2aWV3TWFwQ29udHJvbE9wdGlvbnMge1xuICBjb25zdCBvcHRzOiBCT3ZlcnZpZXdNYXBDb250cm9sT3B0aW9ucyA9IHt9XG5cbiAgaWYgKCFvcHRpb25zKSB7XG4gICAgcmV0dXJuIG9wdHNcbiAgfVxuXG4gIGlmICghaXNOdWxsKG9wdGlvbnMuYW5jaG9yKSkge1xuICAgIG9wdHMuYW5jaG9yID0gb3B0aW9ucy5hbmNob3JcbiAgfVxuICBpZiAoIWlzTnVsbChvcHRpb25zLmlzT3BlbikpIHtcbiAgICBvcHRzLmlzT3BlbiA9IG9wdGlvbnMuaXNPcGVuXG4gIH1cbiAgaWYgKCFpc051bGwob3B0aW9ucy5vZmZzZXQpKSB7XG4gICAgb3B0cy5vZmZzZXQgPSB0b1NpemUob3B0aW9ucy5vZmZzZXQpXG4gIH1cbiAgaWYgKCFpc051bGwob3B0aW9ucy5zaXplKSkge1xuICAgIG9wdHMuc2l6ZSA9IHRvU2l6ZShvcHRpb25zLnNpemUpXG4gIH1cbiAgcmV0dXJuIG9wdHNcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHRvU2NhbGVDb250cm9sT3B0aW9ucyhvcHRpb25zOiBTY2FsZUNvbnRyb2xPcHRpb25zKTogQlNjYWxlQ29udHJvbE9wdGlvbnMge1xuICBjb25zdCBvcHRzOiBCU2NhbGVDb250cm9sT3B0aW9ucyA9IHt9XG5cbiAgaWYgKCFvcHRpb25zKSB7XG4gICAgcmV0dXJuIG9wdHNcbiAgfVxuXG4gIGlmICghaXNOdWxsKG9wdGlvbnMuYW5jaG9yKSkge1xuICAgIG9wdHMuYW5jaG9yID0gb3B0aW9ucy5hbmNob3JcbiAgfVxuICBpZiAoIWlzTnVsbChvcHRpb25zLm9mZnNldCkpIHtcbiAgICBvcHRzLm9mZnNldCA9IHRvU2l6ZShvcHRpb25zLm9mZnNldClcbiAgfVxuICByZXR1cm4gb3B0c1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdG9NYXBUeXBlQ29udHJvbE9wdGlvbnMob3B0aW9uczogTWFwVHlwZUNvbnRyb2xPcHRpb25zKTogQk1hcFR5cGVDb250cm9sT3B0aW9ucyB7XG4gIGNvbnN0IG9wdHM6IEJNYXBUeXBlQ29udHJvbE9wdGlvbnMgPSB7fVxuXG4gIGlmICghb3B0aW9ucykge1xuICAgIHJldHVybiBvcHRzXG4gIH1cblxuICBpZiAoIWlzTnVsbChvcHRpb25zLnR5cGUpKSB7XG4gICAgb3B0cy50eXBlID0gb3B0aW9ucy50eXBlXG4gIH1cbiAgcmV0dXJuIG9wdHNcbn1cbmV4cG9ydCBmdW5jdGlvbiB0b0dlb2xvY2F0aW9uT3B0aW9ucyhvcHRpb25zOiBHZW9sb2NhdGlvbkNvbnRyb2xPcHRpb25zKTogQkdlb2xvY2F0aW9uQ29udHJvbE9wdGlvbnMge1xuICBjb25zdCBvcHRzOiBCR2VvbG9jYXRpb25Db250cm9sT3B0aW9ucyA9IHt9XG5cbiAgaWYgKCFvcHRpb25zKSB7XG4gICAgcmV0dXJuIG9wdHNcbiAgfVxuXG4gIGlmICghaXNOdWxsKG9wdGlvbnMuYW5jaG9yKSkge1xuICAgIG9wdHMuYW5jaG9yID0gb3B0aW9ucy5hbmNob3JcbiAgfVxuICBpZiAoIWlzTnVsbChvcHRpb25zLm9mZnNldCkpIHtcbiAgICBvcHRzLm9mZnNldCA9IHRvU2l6ZShvcHRpb25zLm9mZnNldClcbiAgfVxuICBpZiAoIWlzTnVsbChvcHRpb25zLmVuYWJsZUF1dG9Mb2NhdGlvbikpIHtcbiAgICBvcHRzLmVuYWJsZUF1dG9Mb2NhdGlvbiA9IG9wdGlvbnMuZW5hYmxlQXV0b0xvY2F0aW9uXG4gIH1cbiAgaWYgKCFpc051bGwob3B0aW9ucy5sb2NhdGlvbkljb24pKSB7XG4gICAgb3B0cy5sb2NhdGlvbkljb24gPSB0b0ljb24ob3B0aW9ucy5sb2NhdGlvbkljb24uaW1hZ2VVcmwsIG9wdGlvbnMubG9jYXRpb25JY29uLnNpemUsIG9wdGlvbnMubG9jYXRpb25JY29uKVxuICB9XG4gIGlmICghaXNOdWxsKG9wdGlvbnMuc2hvd0FkZHJlc3NCYXIpKSB7XG4gICAgb3B0cy5zaG93QWRkcmVzc0JhciA9IG9wdGlvbnMuc2hvd0FkZHJlc3NCYXJcbiAgfVxuICByZXR1cm4gb3B0c1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdG9UZXh0SWNvblN0eWxlKHN0eWxlOiBUZXh0SWNvblN0eWxlKTogQlRleHRJY29uU3R5bGUge1xuICBjb25zdCByZWFsU3R5bGU6IEJUZXh0SWNvblN0eWxlID0ge1xuICAgIHVybDogc3R5bGUudXJsLFxuICAgIHNpemU6IHRvU2l6ZShzdHlsZS5zaXplKVxuICB9XG4gIGlmIChzdHlsZS5hbmNob3IpIHtcbiAgICByZWFsU3R5bGUuYW5jaG9yID0gdG9TaXplKHN0eWxlLmFuY2hvcilcbiAgfVxuICBpZiAoc3R5bGUub2Zmc2V0KSB7XG4gICAgcmVhbFN0eWxlLm9mZnNldCA9IHRvU2l6ZShzdHlsZS5vZmZzZXQpXG4gIH1cbiAgaWYgKCFpc051bGwoc3R5bGUudGV4dFNpemUpKSB7XG4gICAgcmVhbFN0eWxlLnRleHRTaXplID0gc3R5bGUudGV4dFNpemVcbiAgfVxuICBpZiAoIWlzTnVsbChzdHlsZS50ZXh0Q29sb3IpKSB7XG4gICAgcmVhbFN0eWxlLnRleHRDb2xvciA9IHN0eWxlLnRleHRDb2xvclxuICB9XG5cbiAgcmV0dXJuIHJlYWxTdHlsZVxufVxuXG5leHBvcnQgZnVuY3Rpb24gdG9NYXJrZXJDbHVzdGVyZXJPcHRpb25zKG9wdGlvbnM6IE1hcmtlckNsdXN0ZXJlck9wdGlvbnMpOiBCTWFya2VyQ2x1c3RlcmVyT3B0aW9ucyB7XG4gIGNvbnN0IG9wdHM6IEJNYXJrZXJDbHVzdGVyZXJPcHRpb25zID0ge31cblxuICBpZiAoIW9wdGlvbnMpIHtcbiAgICByZXR1cm4gb3B0c1xuICB9XG5cbiAgaWYgKG9wdGlvbnMubWFya2Vycykge1xuICAgIG9wdHMubWFya2VycyA9IG9wdGlvbnMubWFya2Vycy5tYXAoXG4gICAgICBtID0+IG5ldyB3aW5kb3cuQk1hcC5NYXJrZXIodG9Qb2ludChtLnBvaW50KSwgdG9NYXJrZXJPcHRpb25zKG0ub3B0aW9ucykpXG4gICAgKVxuICB9XG5cbiAgaWYgKCFpc051bGwob3B0aW9ucy5naXJkU2l6ZSkpIHtcbiAgICBvcHRzLmdpcmRTaXplID0gb3B0aW9ucy5naXJkU2l6ZVxuICB9XG4gIGlmICghaXNOdWxsKG9wdGlvbnMubWF4Wm9vbSkpIHtcbiAgICBvcHRzLm1heFpvb20gPSBvcHRpb25zLm1heFpvb21cbiAgfVxuICBpZiAoIWlzTnVsbChvcHRpb25zLm1pbkNsdXN0ZXJTaXplKSkge1xuICAgIG9wdHMubWluQ2x1c3RlclNpemUgPSBvcHRpb25zLm1pbkNsdXN0ZXJTaXplXG4gIH1cbiAgaWYgKCFpc051bGwob3B0aW9ucy5pc0F2ZXJhbmdlQ2VudGVyKSkge1xuICAgIG9wdHMuaXNBdmVyYW5nZUNlbnRlciA9IG9wdGlvbnMuaXNBdmVyYW5nZUNlbnRlclxuICB9XG4gIGlmIChvcHRpb25zLnN0eWxlcykge1xuICAgIG9wdHMuc3R5bGVzID0gb3B0aW9ucy5zdHlsZXMuZmlsdGVyKHMgPT4gcykubWFwKHMgPT4gdG9UZXh0SWNvblN0eWxlKHMpKVxuICB9XG5cbiAgcmV0dXJuIG9wdHNcbn1cbiJdfQ==